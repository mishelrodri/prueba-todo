"use strict";(self.webpackChunkclinica_fmp_frontend=self.webpackChunkclinica_fmp_frontend||[]).push([[280],{2280:(ge,b,s)=>{s.r(b),s.d(b,{CertificadoModule:()=>_e,options:()=>fe});var p=s(6895),h=s(3599),l=s(433),f=s(7926),T=s(6493),x=s(9861),A=s(8372),q=s(1884),E=s(5226),u=s.n(E),U=s(5930),e=s(1571),C=s(2340),J=s(7579),N=s(529);let k=(()=>{class n{constructor(t){this.http=t,this.api=`${C.N.api}/certificacion`,this.apiPaciente=`${C.N.api}/paciente/sin-certificado`,this.fechaSincrona=new J.x}get formatDate(){return x.Z}obtenerFechaFormateada(){return this.formatDate().format("YYYY")}listarPaciente(){this.http.get(`${this.apiPaciente}`).subscribe({next:t=>{this.pacienteList=t}})}listarPacienteEditar(t){this.http.get(`${this.apiPaciente}/${t}`).subscribe({next:i=>{this.pacienteList=i}})}numeroExpedienteSincrono(t=this.obtenerFechaFormateada()){this.http.get(`${this.api}/numero-expediente/${t}`).subscribe({next:i=>{this.fechaSincrona.next(i)}})}getFechaObservable(){return this.fechaSincrona.asObservable()}listarParametros(t=2,i=0,r="numeroExpediente,asc",o=""){this.http.get(`${this.api}`,{params:{page:i,size:t,sort:r,filtro:o}}).subscribe({next:c=>{this.certificadoList=c}})}eliminar(t){return this.http.delete(`${this.api}/${t}`)}editar(t,i){return this.http.put(`${this.api}/${t}`,i)}agregar(t){return this.http.post(`${this.api}`,t)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(N.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var _=s(9061),v=s(723),F=s(1622),Z=s(1094);function S(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",37),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(),o=e.MAs(65);return e.KtG(r.openLg(o))}),e._UZ(1,"i",38),e.qZA()}}function I(n,a){1&n&&(e.TgZ(0,"span",49),e._uU(1,"Entregado"),e.qZA())}function Y(n,a){1&n&&(e.TgZ(0,"span",50),e._uU(1,"Pendiente"),e.qZA())}function Q(n,a){1&n&&(e.TgZ(0,"span",51),e._uU(1,"Activo"),e.qZA())}function y(n,a){1&n&&(e.TgZ(0,"span",52),e._uU(1,"Inactivo"),e.qZA())}function O(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",53),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit,o=e.oxw(2),c=e.MAs(67);return e.KtG(o.openLgEditar(c,r))}),e._UZ(1,"i",54),e.qZA()}if(2&n){const t=e.oxw().first;e.Q6J("id",t?"editar":null)}}function M(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",55),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit,o=e.oxw(2);return e.KtG(o.eliminar(r.id))}),e._UZ(1,"i",56),e.qZA()}if(2&n){const t=e.oxw().first;e.Q6J("id",t?"inhabilitar":null)}}function P(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e.YNc(8,I,2,0,"span",40),e.YNc(9,Y,2,0,"span",41),e.qZA(),e.TgZ(10,"td"),e.YNc(11,Q,2,0,"span",42),e.YNc(12,y,2,0,"span",43),e.qZA(),e.TgZ(13,"td",44)(14,"button",45),e.NdJ("click",function(){const o=e.CHM(t).$implicit,c=e.oxw(2),m=e.MAs(69);return e.KtG(c.openLgView(m,o))}),e._UZ(15,"i",46),e.qZA(),e.YNc(16,O,2,1,"button",47),e.YNc(17,M,2,1,"button",48),e.qZA()()}if(2&n){const t=a.$implicit,i=a.first,r=e.oxw(2);e.xp6(2),e.Oqu(t.numeroExpediente),e.xp6(2),e.Oqu(r.formatDate(t.fecha).format("LL")),e.xp6(2),e.Oqu(t.paciente.nombre+" "+t.paciente.apellido),e.xp6(2),e.Q6J("ngIf",t.certificado),e.xp6(1),e.Q6J("ngIf",!t.certificado),e.xp6(2),e.Q6J("ngIf",t.estado),e.xp6(1),e.Q6J("ngIf",!t.estado),e.xp6(2),e.Q6J("id",i?"detalle":null),e.xp6(2),e.Q6J("ngIf",r.isEditar||r.isAdmin),e.xp6(1),e.Q6J("ngIf",r.isEliminar&&t.estado||r.isAdmin&&t.estado)}}function G(n,a){if(1&n&&(e.ynx(0),e.YNc(1,P,18,10,"tr",39),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.listar)}}function L(n,a){1&n&&(e.TgZ(0,"tr")(1,"td",57),e._uU(2,"No existen registros disponibles"),e.qZA()())}function w(n,a){1&n&&(e.TgZ(0,"div"),e._uU(1," El n\xfamero de expediente es requerido "),e.qZA())}function z(n,a){1&n&&(e.TgZ(0,"div"),e._uU(1," El n\xfamero de expediente no cumple con el tama\xf1o m\xednimo de 12 caracteres "),e.qZA())}function V(n,a){1&n&&(e.TgZ(0,"div"),e._uU(1," El n\xfamero de expediente no cumple con el tama\xf1o m\xe1ximo de 20 caracteres "),e.qZA())}function K(n,a){1&n&&(e.TgZ(0,"div"),e._uU(1," El n\xfamero de expediente solo debe contener letras y d\xedgitos "),e.qZA())}function $(n,a){if(1&n&&(e.TgZ(0,"div",82),e.YNc(1,w,2,0,"div",83),e.YNc(2,z,2,0,"div",83),e.YNc(3,V,2,0,"div",83),e.YNc(4,K,2,0,"div",83),e.qZA()),2&n){const t=e.oxw(2);let i,r,o,c;e.xp6(1),e.Q6J("ngIf",null==(i=t.form.get("numeroExpediente"))||null==i.errors?null:i.errors.required),e.xp6(1),e.Q6J("ngIf",null==(r=t.form.get("numeroExpediente"))||null==r.errors?null:r.errors.minlength),e.xp6(1),e.Q6J("ngIf",null==(o=t.form.get("numeroExpediente"))||null==o.errors?null:o.errors.maxlength),e.xp6(1),e.Q6J("ngIf",null==(c=t.form.get("numeroExpediente"))||null==c.errors?null:c.errors.pattern)}}function D(n,a){1&n&&(e.TgZ(0,"div"),e._uU(1,"La fecha de creaci\xf3n es requerida"),e.qZA())}function B(n,a){if(1&n&&(e.TgZ(0,"div",82),e.YNc(1,D,2,0,"div",83),e.qZA()),2&n){const t=e.oxw(2);let i;e.xp6(1),e.Q6J("ngIf",null==(i=t.form.get("fecha"))||null==i.errors?null:i.errors.required)}}function j(n,a){1&n&&(e.TgZ(0,"div"),e._uU(1,"El paciente es requerido"),e.qZA())}function H(n,a){if(1&n&&(e.TgZ(0,"div",82),e.YNc(1,j,2,0,"div",83),e.qZA()),2&n){const t=e.oxw(2);let i;e.xp6(1),e.Q6J("ngIf",null==(i=t.form.get("idPaciente"))||null==i.errors?null:i.errors.required)}}const g=function(n,a){return{"is-invalid":n,"is-valid":a}};function R(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",58)(1,"h4",59),e._uU(2,"Agregar nuevo ingreso"),e.qZA(),e.TgZ(3,"button",60),e.NdJ("click",function(){const o=e.CHM(t).$implicit;return e.KtG(o.dismiss("Cross click"))}),e.qZA()(),e.TgZ(4,"form",61),e.NdJ("ngSubmit",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.guardar())}),e.TgZ(5,"div",62)(6,"div",0)(7,"div",63)(8,"div",64)(9,"div",65)(10,"label",66),e._uU(11,"N\xfamero de expediente"),e.qZA(),e.TgZ(12,"span",67),e._uU(13," *"),e.qZA(),e._UZ(14,"input",68),e.YNc(15,$,5,4,"div",69),e.qZA()(),e.TgZ(16,"div",70)(17,"div",65)(18,"div")(19,"label",71),e._uU(20,"Manual"),e.qZA()(),e.TgZ(21,"div",72)(22,"input",73),e.NdJ("change",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.cambiarManual())}),e.qZA()()()(),e.TgZ(23,"div",74)(24,"div",65)(25,"label",75),e._uU(26,"Fecha de creaci\xf3n"),e.qZA(),e.TgZ(27,"span",67),e._uU(28," *"),e.qZA(),e.TgZ(29,"input",76),e.NdJ("change",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.capturarFecha())}),e.qZA(),e.YNc(30,B,2,1,"div",69),e.qZA()()(),e.TgZ(31,"div",63)(32,"div",74)(33,"div",65)(34,"label",77),e._uU(35,"Paciente"),e.qZA(),e.TgZ(36,"span",67),e._uU(37," *"),e.qZA(),e._UZ(38,"ng-select",78),e.YNc(39,H,2,1,"div",69),e.qZA()(),e.TgZ(40,"div",74),e._UZ(41,"div",65),e.qZA()()()(),e.TgZ(42,"div",79)(43,"button",80),e.NdJ("click",function(){const o=e.CHM(t).$implicit;return e.KtG(o.close("Close click"))}),e._uU(44,"Cerrar"),e.qZA(),e.TgZ(45,"button",81),e._uU(46,"Guardar"),e.qZA()()()}if(2&n){const t=e.oxw();let i,r,o,c,m;e.xp6(4),e.Q6J("formGroup",t.form),e.xp6(10),e.Q6J("dropSpecialCharacters",!1)("ngClass",e.WLB(9,g,t.seGuardo&&(null==(i=t.form.get("numeroExpediente"))?null:i.errors),t.seGuardo&&(null==(i=t.form.get("numeroExpediente"))?null:i.valid))),e.xp6(1),e.Q6J("ngIf",null==(r=t.form.get("numeroExpediente"))?null:r.errors),e.xp6(14),e.Q6J("ngClass",e.WLB(12,g,t.seGuardo&&(null==(o=t.form.get("fecha"))?null:o.errors),t.seGuardo&&(null==(o=t.form.get("fecha"))?null:o.valid)))("max",t.maxDate()),e.xp6(1),e.Q6J("ngIf",null==(c=t.form.get("fecha"))?null:c.errors),e.xp6(8),e.Q6J("items",t.listarPaciente),e.xp6(1),e.Q6J("ngIf",null==(m=t.form.get("idPaciente"))?null:m.errors)}}function W(n,a){1&n&&(e.TgZ(0,"div"),e._uU(1," El n\xfamero de expediente es requerido "),e.qZA())}function X(n,a){1&n&&(e.TgZ(0,"div"),e._uU(1," El n\xfamero de expediente no cumple con el tama\xf1o m\xednimo de 12 caracteres "),e.qZA())}function ee(n,a){1&n&&(e.TgZ(0,"div"),e._uU(1," El n\xfamero de expediente no cumple con el tama\xf1o m\xe1ximo de 20 caracteres "),e.qZA())}function te(n,a){1&n&&(e.TgZ(0,"div"),e._uU(1," El n\xfamero de expediente solo debe contener letras y d\xedgitos "),e.qZA())}function ie(n,a){if(1&n&&(e.TgZ(0,"div",82),e.YNc(1,W,2,0,"div",83),e.YNc(2,X,2,0,"div",83),e.YNc(3,ee,2,0,"div",83),e.YNc(4,te,2,0,"div",83),e.qZA()),2&n){const t=e.oxw(2);let i,r,o,c;e.xp6(1),e.Q6J("ngIf",null==(i=t.form.get("numeroExpediente"))||null==i.errors?null:i.errors.required),e.xp6(1),e.Q6J("ngIf",null==(r=t.form.get("numeroExpediente"))||null==r.errors?null:r.errors.minlength),e.xp6(1),e.Q6J("ngIf",null==(o=t.form.get("numeroExpediente"))||null==o.errors?null:o.errors.maxlength),e.xp6(1),e.Q6J("ngIf",null==(c=t.form.get("numeroExpediente"))||null==c.errors?null:c.errors.pattern)}}function ne(n,a){1&n&&(e.TgZ(0,"div"),e._uU(1,"La fecha de creaci\xf3n es requerida"),e.qZA())}function re(n,a){if(1&n&&(e.TgZ(0,"div",82),e.YNc(1,ne,2,0,"div",83),e.qZA()),2&n){const t=e.oxw(2);let i;e.xp6(1),e.Q6J("ngIf",null==(i=t.form.get("fecha"))||null==i.errors?null:i.errors.required)}}function oe(n,a){1&n&&(e.TgZ(0,"div"),e._uU(1,"El paciente es requerido"),e.qZA())}function ae(n,a){if(1&n&&(e.TgZ(0,"div",82),e.YNc(1,oe,2,0,"div",83),e.qZA()),2&n){const t=e.oxw(2);let i;e.xp6(1),e.Q6J("ngIf",null==(i=t.form.get("idPaciente"))||null==i.errors?null:i.errors.required)}}function se(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div")(2,"label",88),e._uU(3,"Estado"),e.qZA()(),e.TgZ(4,"div",72)(5,"input",89),e.NdJ("change",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.cambiarEstado())}),e.qZA(),e.TgZ(6,"label",90),e._uU(7),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(7),e.Oqu(t.estadoActual)}}function ce(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",58)(1,"h4",59),e._uU(2,"Editar nuevo ingreso"),e.qZA(),e.TgZ(3,"button",60),e.NdJ("click",function(){const o=e.CHM(t).$implicit;return e.KtG(o.dismiss("Cross click"))}),e.qZA()(),e.TgZ(4,"form",61),e.NdJ("ngSubmit",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.editar())}),e.TgZ(5,"div",62)(6,"div",0)(7,"div",63)(8,"div",74)(9,"div",65)(10,"label",66),e._uU(11,"N\xfamero de expediente"),e.qZA(),e.TgZ(12,"span",67),e._uU(13," *"),e.qZA(),e._UZ(14,"input",68),e.YNc(15,ie,5,4,"div",69),e.qZA()(),e.TgZ(16,"div",74)(17,"div",65)(18,"label",75),e._uU(19,"Fecha de creaci\xf3n"),e.qZA(),e.TgZ(20,"span",67),e._uU(21," *"),e.qZA(),e._UZ(22,"input",84),e.YNc(23,re,2,1,"div",69),e.qZA()()(),e.TgZ(24,"div",63)(25,"div",74)(26,"div",65)(27,"label",77),e._uU(28,"Paciente"),e.qZA(),e.TgZ(29,"span",67),e._uU(30," *"),e.qZA(),e._UZ(31,"ng-select",78),e.YNc(32,ae,2,1,"div",69),e.qZA()(),e.TgZ(33,"div",74)(34,"div",65)(35,"div")(36,"label",85),e._uU(37,"Certificado"),e.qZA()(),e.TgZ(38,"div",72)(39,"input",86),e.NdJ("change",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.cambiarCertificado())}),e.qZA(),e.TgZ(40,"label",87),e._uU(41),e.qZA()()()()(),e.TgZ(42,"div",63)(43,"div",74)(44,"div",65),e.YNc(45,se,8,1,"ng-container",83),e.qZA()(),e.TgZ(46,"div",74),e._UZ(47,"div",65),e.qZA()()()(),e.TgZ(48,"div",79)(49,"button",80),e.NdJ("click",function(){const o=e.CHM(t).$implicit;return e.KtG(o.close("Close click"))}),e._uU(50,"Cerrar"),e.qZA(),e.TgZ(51,"button",81),e._uU(52,"Guardar"),e.qZA()()()}if(2&n){const t=e.oxw();let i,r,o,c,m;e.xp6(4),e.Q6J("formGroup",t.form),e.xp6(10),e.Q6J("dropSpecialCharacters",!1)("ngClass",e.WLB(11,g,t.seGuardo&&(null==(i=t.form.get("numeroExpediente"))?null:i.errors),t.seGuardo&&(null==(i=t.form.get("numeroExpediente"))?null:i.valid))),e.xp6(1),e.Q6J("ngIf",null==(r=t.form.get("numeroExpediente"))?null:r.errors),e.xp6(7),e.Q6J("ngClass",e.WLB(14,g,t.seGuardo&&(null==(o=t.form.get("fecha"))?null:o.errors),t.seGuardo&&(null==(o=t.form.get("fecha"))?null:o.valid)))("max",t.maxDate()),e.xp6(1),e.Q6J("ngIf",null==(c=t.form.get("fecha"))?null:c.errors),e.xp6(8),e.Q6J("items",t.listarPaciente),e.xp6(1),e.Q6J("ngIf",null==(m=t.form.get("idPaciente"))?null:m.errors),e.xp6(9),e.Oqu(t.certificadoActual),e.xp6(4),e.Q6J("ngIf",!t.mostrarEstado&&t.isAdmin)}}function le(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",58)(1,"h4",59),e._uU(2,"Ver detalles del nuevo ingreso"),e.qZA(),e.TgZ(3,"button",60),e.NdJ("click",function(){const o=e.CHM(t).$implicit;return e.KtG(o.dismiss("Cross click"))}),e.qZA()(),e.TgZ(4,"div",62)(5,"div",0)(6,"div",63)(7,"div",74)(8,"div",65)(9,"label",91),e._uU(10,"N\xfamero de Expediente"),e.qZA(),e.TgZ(11,"p"),e._uU(12),e.qZA()()(),e.TgZ(13,"div",74)(14,"div",65)(15,"label",91),e._uU(16,"Fecha de creaci\xf3n"),e.qZA(),e.TgZ(17,"p"),e._uU(18),e.qZA()()()(),e.TgZ(19,"div",63)(20,"div",74)(21,"div",65)(22,"label",91),e._uU(23,"Paciente"),e.qZA(),e.TgZ(24,"p"),e._uU(25),e.qZA()()(),e.TgZ(26,"div",74)(27,"div",65)(28,"label",91),e._uU(29,"Certificado"),e.qZA(),e.TgZ(30,"p"),e._uU(31),e.qZA()()()(),e.TgZ(32,"div",63)(33,"div",74)(34,"div",65)(35,"label",91),e._uU(36,"Estado"),e.qZA(),e.TgZ(37,"p"),e._uU(38),e.qZA()()(),e.TgZ(39,"div",74),e._UZ(40,"div",65),e.qZA()()()(),e.TgZ(41,"div",79)(42,"button",80),e.NdJ("click",function(){const o=e.CHM(t).$implicit;return e.KtG(o.close("Close click"))}),e._uU(43,"Cerrar"),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(12),e.Oqu(t.certificado.numeroExpediente),e.xp6(6),e.Oqu(t.formatDate(t.certificado.fecha).format("LL")),e.xp6(7),e.hij(" ",t.certificado.paciente.nombre+" "+t.certificado.paciente.apellido," "),e.xp6(6),e.hij(" ",t.certificado.certificado?"Entregado":"Pendiente"," "),e.xp6(7),e.Oqu(t.certificado.estado?"Activo":"Inactivo")}}const d=function(n){return{"d-none":n}},me=[{path:"",component:(()=>{class n{constructor(t,i,r,o,c){this.service=t,this.modalService=i,this.fb=r,this.config=o,this.tokenService=c,this.pageList=f.Hj,this.maxSize=f.$,this.page=f.Md,this.size=f.dp,this.seGuardo=!1,this.cambioOrden=!0,this.mostrarEstado=!1,this.estadoActual="Activo",this.certificadoActual="Entregado",this.vicios=[{vicio:"TABACO"},{vicio:"ALCOHOL"},{vicio:"DROGAS"}],this.sort="numeroExpediente,asc",this.isVer=!1,this.isCrear=!1,this.isEditar=!1,this.isEliminar=!1,this.isAdmin=!1,this.permiso="NUEVO_INGRESO_",this.config.notFoundText="No se encontraron resultados",this.buscar=this.fb.group({filter:["",[]]}),this.form=this.fb.group({manual:["",[]],activar:["",[]],numeroExpediente:["",[l.kI.required,l.kI.minLength(12),l.kI.maxLength(20),l.kI.pattern(T.cP)]],fecha:["",[l.kI.required]],idPaciente:["",[l.kI.required]],certificado:["",[]],estado:["",[]]})}ngOnInit(){this.isAdmin=this.tokenService.isSuperAdmin(),this.isVer=this.tokenService.isPermisos(this.permiso,"VER"),this.isCrear=this.tokenService.isPermisos(this.permiso,"CREAR"),this.isEditar=this.tokenService.isPermisos(this.permiso,"EDITAR"),this.isEliminar=this.tokenService.isPermisos(this.permiso,"ELIMINAR"),this.buscar.get("filter")?.valueChanges.pipe((0,A.b)(500),(0,q.x)()).subscribe(t=>{this.page=0,this.service.listarParametros(this.size,this.page,this.sort,t)}),this.service.listarPaciente(),this.service.numeroExpedienteSincrono()}get listar(){return this.service.certificadoList?this.service.certificadoList.content:[]}get listarPaciente(){return this.service.pacienteList?this.service.pacienteList:[]}get listarTotal(){return this.service.certificadoList?this.service.certificadoList.totalElements:0}get filter(){return this.buscar.get("filter")?this.buscar.get("filter")?.value:""}get formatDate(){return x.Z}maxDate(){return this.formatDate().format("YYYY-MM-DD")}cambiarEstado(){this.estadoActual=this.form.get("estado")?.value?"Activo":"Inactivo"}refresh(){this.service.listarParametros(this.size,this.page-1,this.sort,this.filter)}refreshSize(){this.page=0,this.service.listarParametros(this.size,this.page,this.sort,this.filter)}ordenar(t){this.cambioOrden=!this.sort.includes(t)||!this.cambioOrden,this.page=0,this.sort=this.cambioOrden?t+",asc":t+",desc",this.service.listarParametros(this.size,this.page,this.sort,this.filter)}cambiarCertificado(){this.certificadoActual=this.form.get("certificado")?.value?"Entregado":"Pendiente"}cambiarManual(){this.form.get("manual")?.value?this.form.get("numeroExpediente")?.enable():this.form.get("numeroExpediente")?.disable()}obtenerFechaFormateada(){return this.formatDate().format("YYYY-MM-DD")}capturarFecha(){const t=this.formatDate(this.form.get("fecha")?.value);!t.isValid()||(this.service.numeroExpedienteSincrono(t.format("YYYY")),this.service.getFechaObservable().subscribe(i=>{this.form.patchValue({numeroExpediente:i.numeroExpediente})}))}openLg(t){this.seGuardo=!1,this.reiniciarFormulario(),this.cambiarManual(),this.modalService.open(t,{size:"lg"})}openLgEditar(t,i){this.seGuardo=!1,this.certificado=i,this.service.listarPacienteEditar(this.certificado.paciente.id),this.mostrarEstado=this.certificado.estado,this.form.patchValue({numeroExpediente:this.certificado.numeroExpediente,fecha:this.certificado.fecha,certificado:this.certificado.certificado,idPaciente:this.certificado.paciente.id,estado:this.certificado.estado}),this.form.get("numeroExpediente")?.disable(),this.cambiarEstado(),this.cambiarCertificado(),this.modalService.open(t,{size:"lg"})}openLgView(t,i){this.certificado=i,this.modalService.open(t,{size:"lg"})}reiniciarFormulario(){this.service.listarPaciente(),this.service.numeroExpedienteSincrono(),this.service.getFechaObservable().subscribe(t=>{this.form.patchValue({numeroExpediente:t.numeroExpediente})}),this.form.patchValue({manual:!1,activar:!1,fecha:this.obtenerFechaFormateada(),idPaciente:null,estado:!1})}guardar(){this.seGuardo=!0,this.form.valid?(this.form.get("numeroExpediente")?.enable(),this.service.agregar(this.form.value).subscribe({next:()=>{u().fire({position:"center",title:"\xa1\xc9xito!",text:"Los datos se han guardado correctamente.",icon:"success"}),this.service.listarParametros(this.size,this.page-1,this.sort,this.filter),this.reiniciarFormulario(),this.seGuardo=!1,this.modalService.dismissAll()},error:i=>{u().fire({position:"center",title:"Ocurri\xf3 un error",text:i.error.mensaje,icon:"error"})}})):u().fire({position:"center",title:"Datos incompletos",text:"Por favor, revisa los campos marcados.",icon:"warning"})}editar(){if(this.seGuardo=!0,!this.form.valid)return void u().fire({position:"center",title:"Datos incompletos",text:"Por favor, revisa los campos marcados.",icon:"warning"});this.form.get("numeroExpediente")?.enable(),this.form.get("otro")?.enable();const t=this.form.value;t.certificado&&this.mostrarEstado&&(t.estado=!1),this.service.editar(this.certificado.id,t).subscribe({next:()=>{u().fire({position:"center",title:"\xa1\xc9xito!",text:"Los datos se han guardado correctamente.",icon:"success"}),this.service.listarParametros(this.size,this.page-1,this.sort,this.filter),this.reiniciarFormulario(),this.seGuardo=!1,this.modalService.dismissAll()},error:i=>{u().fire({position:"center",title:"Ocurri\xf3 un error",text:i.error.mensaje,icon:"error"})}})}eliminar(t){u().fire({title:"\xbfConfirmar inhabilitaci\xf3n?",text:"Esta acci\xf3n marcar\xe1 el registro como inhabilitado, pero no lo eliminar\xe1 definitivamente.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xed, inhabilitar",cancelButtonText:"Cancelar"}).then(i=>{i.isConfirmed&&(this.service.eliminar(t).subscribe({next:r=>{r&&this.service.listarParametros(this.size,this.page-1,this.sort,this.filter)}}),u().fire("Inhabilitado","El registro ha sido marcado como inhabilitado exitosamente.","success"))})}iniciarAyuda(){const t=[(this.isCrear||this.isAdmin)&&{element:"#nuevoRegistro",popover:{title:"Crear un nuevo registro",description:"Aqu\xed puedes crear un nuevo registro para nuevo ingreso",side:"left",align:"start"}},{element:"#cantidad",popover:{title:"Cantidad de registros a mostrar",description:"Aqu\xed puedes establecer la cantidad de informaci\xf3n que se muestra en la tabla",side:"right",align:"start"}},{element:"#buscar",popover:{title:"Filtrar registros",description:"Aqu\xed puedes filtrar la informaci\xf3n",side:"top",align:"start"}},(this.isVer||this.isAdmin)&&this.listar.length>0&&{element:"#detalle",popover:{title:"Ver detalles de un registro",description:"Aqu\xed puedes acceder a informaci\xf3n detallada sobre un registro",side:"left",align:"start"}},(this.isEditar||this.isAdmin)&&this.listar.length>0&&{element:"#editar",popover:{title:"Editar un registro",description:"Aqu\xed puedes editar un registro",side:"left",align:"start"}},(this.isEliminar||this.isAdmin)&&this.listar.length>0&&this.listar[0].estado&&{element:"#inhabilitar",popover:{title:"Inhabilitar un registro",description:"Aqu\xed puedes inhabilitar un registro",side:"left",align:"start"}},{element:"#paginacion",popover:{title:"Seleccionar p\xe1gina de registro",description:"Aqu\xed puedes seleccionar la p\xe1gina de la informaci\xf3n que deseas mostrar",side:"left",align:"end"}}].filter(Boolean).map(r=>r);(0,U.v)({showProgress:!0,nextBtnText:"Siguiente",prevBtnText:"Anterior",doneBtnText:"Finalizar",progressText:"{{current}} de {{total}}",steps:t}).drive()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(k),e.Y36(_.FF),e.Y36(l.qu),e.Y36(v.$q),e.Y36(F.B))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-certificado"]],decls:70,vars:44,consts:[[1,"container-fluid"],[1,"header__page","d-flex","justify-content-end","mb-3"],["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink",""],["aria-current","page",1,"breadcrumb-item","active"],[1,"d-flex","justify-content-between","mb-3"],[1,"d-flex","align-items-center"],[1,"fs-3"],[1,"btn","text-primary","fs-5",3,"click"],[1,"bi","bi-info-circle-fill"],["type","button","class","btn btn-primary","id","nuevoRegistro",3,"click",4,"ngIf"],[1,"d-flex","flex-column","gap-2","flex-lg-row","justify-content-between","mb-3"],["id","cantidad",1,"d-flex","align-items-center","mb-3"],["for","pageSize",1,"col-form-label","me-2"],["id","pageSize","bindLabel","value","bindValue","value",3,"items","ngModel","clearable","ngModelChange"],["for","pageSize",1,"col-form-label","ms-2"],[3,"formGroup"],["id","buscar",1,"d-flex","align-items-center","mb-3"],["for","filter",1,"col-form-label","me-2"],["id","filter","type","text","formControlName","filter",1,"form-control"],[1,"table-responsive","mb-3"],[1,"table","align-middle"],[1,"border-dark"],["scope","col",3,"click"],[1,"bi","bi-caret-up-fill",3,"ngClass"],[1,"bi","bi-caret-down-fill",3,"ngClass"],["scope","col"],[4,"ngIf","ngIfElse"],["noRecords",""],[1,"d-flex","flex-column","gap-2","flex-lg-row","justify-content-between"],[1,"text-black"],["id","paginacion",3,"collectionSize","page","pageSize","maxSize","rotate","boundaryLinks","pageChange"],["content",""],["contentEdit",""],["contentView",""],["type","button","id","nuevoRegistro",1,"btn","btn-primary",3,"click"],[1,"bi","bi-plus-square"],[4,"ngFor","ngForOf"],["class","badge bg-primary",4,"ngIf"],["class","badge bg-warning text-black",4,"ngIf"],["class","badge bg-success",4,"ngIf"],["class","badge bg-danger",4,"ngIf"],[1,"d-flex","flex-row"],["type","button",1,"btn","btn-outline-secondary","me-2",3,"id","click"],[1,"bi","bi-eye"],["type","button","class","btn btn-outline-success me-2",3,"id","click",4,"ngIf"],["type","button","class","btn btn-outline-danger",3,"id","click",4,"ngIf"],[1,"badge","bg-primary"],[1,"badge","bg-warning","text-black"],[1,"badge","bg-success"],[1,"badge","bg-danger"],["type","button",1,"btn","btn-outline-success","me-2",3,"id","click"],[1,"bi","bi-pencil"],["type","button",1,"btn","btn-outline-danger",3,"id","click"],[1,"bi","bi-x-lg"],["colspan","6",1,"text-center"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[3,"formGroup","ngSubmit"],[1,"modal-body"],[1,"row"],[1,"col-10","col-lg-5"],[1,"mb-3"],["for","numeroExpediente",1,"form-label"],[1,"text-danger"],["type","text","formControlName","numeroExpediente","id","numeroExpediente","placeholder","Ingrese el n\xfamero de expediente","mask","SSSSS0000000",1,"form-control",3,"dropSpecialCharacters","ngClass"],["class","invalid-feedback",4,"ngIf"],[1,"col-2","col-lg-1"],["for","manual",1,"form-label"],[1,"form-check","form-switch"],["type","checkbox","id","manual","formControlName","manual",1,"form-check-input",3,"change"],[1,"col-12","col-lg-6"],["for","fecha",1,"form-label"],["type","date","formControlName","fecha","id","fecha",1,"form-control",3,"ngClass","max","change"],["for","idPaciente",1,"form-label"],["formControlName","idPaciente","id","idPaciente","placeholder","Seleccione al paciente","bindLabel","labelPaciente","bindValue","id",3,"items"],[1,"modal-footer"],["type","button",1,"btn","btn-light",3,"click"],["type","submit",1,"btn","btn-primary"],[1,"invalid-feedback"],[4,"ngIf"],["type","date","formControlName","fecha","id","fecha",1,"form-control",3,"ngClass","max"],["for","certificado",1,"form-label"],["type","checkbox","id","certificado","formControlName","certificado",1,"form-check-input",3,"change"],["for","certificado",1,"form-check-label"],["for","estado",1,"form-label"],["type","checkbox","id","estado","formControlName","estado",1,"form-check-input",3,"change"],["for","estado",1,"form-check-label"],[1,"form-label","fw-bold"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"nav",2)(3,"ol",3)(4,"li",4)(5,"a",5),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"li",6),e._uU(8,"Nuevo ingreso"),e.qZA()()()(),e.TgZ(9,"div",7)(10,"div",8)(11,"h1",9),e._uU(12,"Nuevo ingreso"),e.qZA(),e.TgZ(13,"button",10),e.NdJ("click",function(){return i.iniciarAyuda()}),e._UZ(14,"i",11),e.qZA()(),e.TgZ(15,"div"),e.YNc(16,S,2,0,"button",12),e.qZA()(),e.TgZ(17,"div",13)(18,"div",14)(19,"label",15),e._uU(20,"Mostrar:"),e.qZA(),e.TgZ(21,"ng-select",16),e.NdJ("ngModelChange",function(o){return i.size=o})("ngModelChange",function(){return i.refreshSize()}),e.qZA(),e.TgZ(22,"label",17),e._uU(23,"registros"),e.qZA()(),e.TgZ(24,"form",18)(25,"div",19)(26,"label",20),e._uU(27,"Buscar:"),e.qZA(),e._UZ(28,"input",21),e.qZA()()(),e.TgZ(29,"div",22)(30,"table",23)(31,"thead")(32,"tr",24)(33,"th",25),e.NdJ("click",function(){return i.ordenar("numeroExpediente")}),e._uU(34," # Expediente"),e._UZ(35,"i",26)(36,"i",27),e.qZA(),e.TgZ(37,"th",25),e.NdJ("click",function(){return i.ordenar("fecha")}),e._uU(38," Fecha de Creaci\xf3n"),e._UZ(39,"i",26)(40,"i",27),e.qZA(),e.TgZ(41,"th",25),e.NdJ("click",function(){return i.ordenar("paciente.nombre")}),e._uU(42," Paciente"),e._UZ(43,"i",26)(44,"i",27),e.qZA(),e.TgZ(45,"th",25),e.NdJ("click",function(){return i.ordenar("certificado")}),e._uU(46," Certificado"),e._UZ(47,"i",26)(48,"i",27),e.qZA(),e.TgZ(49,"th",25),e.NdJ("click",function(){return i.ordenar("estado")}),e._uU(50," Estado"),e._UZ(51,"i",26)(52,"i",27),e.qZA(),e.TgZ(53,"th",28),e._uU(54,"Acciones"),e.qZA()()(),e.TgZ(55,"tbody"),e.YNc(56,G,2,1,"ng-container",29),e.YNc(57,L,3,0,"ng-template",null,30,e.W1O),e.qZA()()(),e.TgZ(59,"div",31)(60,"div")(61,"p",32),e._uU(62),e.qZA()(),e.TgZ(63,"ngb-pagination",33),e.NdJ("pageChange",function(o){return i.page=o})("pageChange",function(){return i.refresh()}),e.qZA()()(),e.YNc(64,R,47,15,"ng-template",null,34,e.W1O),e.YNc(66,ce,53,17,"ng-template",null,35,e.W1O),e.YNc(68,le,44,5,"ng-template",null,36,e.W1O)),2&t){const r=e.MAs(58);e.xp6(16),e.Q6J("ngIf",i.isCrear||i.isAdmin),e.xp6(5),e.Q6J("items",i.pageList)("ngModel",i.size)("clearable",!1),e.xp6(3),e.Q6J("formGroup",i.buscar),e.xp6(11),e.Q6J("ngClass",e.VKq(24,d,"numeroExpediente,asc"!==i.sort||!i.cambioOrden)),e.xp6(1),e.Q6J("ngClass",e.VKq(26,d,"numeroExpediente,desc"!==i.sort||i.cambioOrden)),e.xp6(3),e.Q6J("ngClass",e.VKq(28,d,"fecha,asc"!==i.sort||!i.cambioOrden)),e.xp6(1),e.Q6J("ngClass",e.VKq(30,d,"fecha,desc"!==i.sort||i.cambioOrden)),e.xp6(3),e.Q6J("ngClass",e.VKq(32,d,"paciente.nombre,asc"!==i.sort||!i.cambioOrden)),e.xp6(1),e.Q6J("ngClass",e.VKq(34,d,"paciente.nombre,desc"!==i.sort||i.cambioOrden)),e.xp6(3),e.Q6J("ngClass",e.VKq(36,d,"certificado,desc"!==i.sort||i.cambioOrden)),e.xp6(1),e.Q6J("ngClass",e.VKq(38,d,"certificado,asc"!==i.sort||!i.cambioOrden)),e.xp6(3),e.Q6J("ngClass",e.VKq(40,d,"estado,desc"!==i.sort||i.cambioOrden)),e.xp6(1),e.Q6J("ngClass",e.VKq(42,d,"estado,asc"!==i.sort||!i.cambioOrden)),e.xp6(4),e.Q6J("ngIf",i.listar.length>0)("ngIfElse",r),e.xp6(6),e.hij("Total de resgistros: ",i.listarTotal,""),e.xp6(1),e.Q6J("collectionSize",i.listarTotal)("page",i.page)("pageSize",i.size)("maxSize",i.maxSize)("rotate",!0)("boundaryLinks",!0)}},dependencies:[p.mk,p.sg,p.O5,h.yS,l._Y,l.Fj,l.Wl,l.JJ,l.JL,l.On,l.sg,l.u,_.N9,v.w9,Z.hx]}),n})(),canActivate:[s(2466).i],data:{expectedAuthorities:["NUEVO_INGRESO"]}}];let pe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[h.Bz.forChild(me),h.Bz]}),n})();const fe=null;let _e=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[p.ez,pe,l.u5,l.UX,_.jF,_.ZS,v.A0,Z.yI.forRoot()]}),n})()}}]);