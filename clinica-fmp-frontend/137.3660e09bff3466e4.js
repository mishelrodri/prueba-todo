"use strict";(self.webpackChunkclinica_fmp_frontend=self.webpackChunkclinica_fmp_frontend||[]).push([[137],{9137:(y,b,s)=>{s.r(b),s.d(b,{AuthModule:()=>T});var v=s(6895),c=s(3599),t=s(1571),n=s(433);class h{constructor(i,e){this.nombreUsuario=i,this.password=e}}var m=s(7556),l=s(1622),g=s(5226),a=s.n(g);let u=(()=>{class o{constructor(){this.toggleBtn=!1,this.fb=(0,t.f3M)(n.qu),this.tokenService=(0,t.f3M)(l.B),this.authService=(0,t.f3M)(m.e),this.router=(0,t.f3M)(c.F0),this.imagenUrl=""}ngOnInit(){this.formularioLogin=this.iniciarFormulario()}seePassword(){this.toggleBtn=!this.toggleBtn}iniciarFormulario(){return this.fb.group({usuario:["",[n.kI.required]],contrasenia:["",[n.kI.required]]})}onLogin(){this.loginUsuario=new h(this.formularioLogin.get("usuario")?.value,this.formularioLogin.get("contrasenia")?.value),this.authService.login(this.loginUsuario).subscribe({next:e=>{this.tokenService.setToken(e.token),this.router.navigate(["/inicio"])},error:()=>{a().fire({title:"Datos Incorrectos",text:"Vuelve a intentarlo"})}})}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-login"]],decls:22,vars:5,consts:[[1,"container-login"],[1,"card","card-width"],[1,"card-body"],[1,"card-image"],["src","assets/images/minerva.webp","alt","UES LOGO"],[1,"fw-bolder","title"],[1,"text-center","paragraph"],[1,"form",3,"formGroup","ngSubmit"],[1,"mb-3"],["formControlName","usuario","id","usuario","name","usuario","type","text","placeholder","Nombre de usuario","autocomplete","off",1,"form-control","no-outline"],[1,"input-group","mb-3"],["formControlName","contrasenia","id","contra","name","contra","id","contrasenia","placeholder","Contrase\xf1a",1,"form-control",3,"type"],["type","button","id","basic-addon1",1,"input-group-text","bg-transparent",3,"click"],["type","submit",1,"btn-confirm",3,"disabled"],[1,"recuperar"],["routerLink","/restablecer",1,"link"]],template:function(e,r){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),t._UZ(4,"img",4),t.qZA(),t.TgZ(5,"h1",5),t._uU(6,"Inicio Sesi\xf3n"),t.qZA(),t.TgZ(7,"p",6),t._uU(8,"\xa1Bienvenidos al sistema de la Cl\xednica de Bienestar Universitario de la FMP!"),t.qZA(),t.TgZ(9,"form",7),t.NdJ("ngSubmit",function(){return r.onLogin()}),t.TgZ(10,"div",8),t._UZ(11,"input",9),t.qZA(),t.TgZ(12,"div",10),t._UZ(13,"input",11),t.TgZ(14,"button",12),t.NdJ("click",function(){return r.seePassword()}),t._UZ(15,"i"),t.qZA()(),t.TgZ(16,"div",8)(17,"button",13),t._uU(18,"Acceder"),t.qZA()(),t.TgZ(19,"div",14)(20,"a",15),t._uU(21,"Recuperar contrase\xf1a"),t.qZA()()()()()()),2&e&&(t.xp6(9),t.Q6J("formGroup",r.formularioLogin),t.xp6(4),t.Q6J("type",r.toggleBtn?"text":"password"),t.xp6(2),t.Tol(r.toggleBtn?"bi bi-eye-slash-fill":"bi bi-eye-fill"),t.xp6(2),t.Q6J("disabled",r.formularioLogin.invalid))},dependencies:[c.yS,n._Y,n.Fj,n.JJ,n.JL,n.sg,n.u],styles:[".container-login[_ngcontent-%COMP%]{width:100%;height:100vh;height:100dvh;background:var(--light);display:grid;grid-template-columns:100%;place-content:center;justify-items:center}.container-login[_ngcontent-%COMP%]   .card-width[_ngcontent-%COMP%]{width:90%}@media only screen and (min-width: 800px){.container-login[_ngcontent-%COMP%]   .card-width[_ngcontent-%COMP%]{width:50%}}.container-login[_ngcontent-%COMP%]   .card-width[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;gap:10px}.card-image[_ngcontent-%COMP%]{width:100px;height:140px;overflow:hidden}.card-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:contain;width:100%}.title[_ngcontent-%COMP%]{font-size:24px}.paragraph[_ngcontent-%COMP%]{font-size:14px}@media only screen and (min-width: 800px){.paragraph[_ngcontent-%COMP%]{width:50%;font-size:16px}}.form[_ngcontent-%COMP%]{width:80%}@media only screen and (min-width: 800px){.form[_ngcontent-%COMP%]{width:50%}}.btn-confirm[_ngcontent-%COMP%]{width:100%;display:block;background-color:var(--red);color:#fff;padding:10px 34px;border-radius:4px;border:none;transition:.3s background}.btn-confirm[_ngcontent-%COMP%]:hover{background-color:#bf1131}.recuperar[_ngcontent-%COMP%]{display:flex;justify-content:center}.recuperar[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#0d6efd}"]}),o})();var d=s(5861);let f=(()=>{class o{constructor(){this.tokenService=(0,t.f3M)(l.B),this.router=(0,t.f3M)(c.F0)}canActivate(){var e=this;return(0,d.Z)(function*(){if(e.tokenService.isLogged())try{return!(yield e.tokenService.validarToken().toPromise())||(e.router.navigate(["/inicio"]),!1)}catch{return!0}return!0})()}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();class P{constructor(i){this.mailTo=i}}var x=s(529),Z=s(2340);let w=(()=>{class o{constructor(){this.changePasswordURL=`${Z.N.api}/email-password/`,this.httpClient=(0,t.f3M)(x.eN)}sendEmail(e){return this.httpClient.post(this.changePasswordURL+"send-email",e)}changePassword(e){return this.httpClient.post(this.changePasswordURL+"change-password",e)}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),O=(()=>{class o{constructor(e,r){this.emailPasswordService=e,this.fb=r}ngOnInit(){this.formularioEmail=this.iniciarFormulario()}iniciarFormulario(){return this.fb.group({correo:["",[n.kI.required]]})}onSendEmail(){this.emailDTO=new P(this.formularioEmail.get("correo")?.value),a().fire({title:"Enviando correo",text:"Por favor, espere un momento...",allowOutsideClick:!1,didOpen:()=>{a().showLoading()}}),this.emailPasswordService.sendEmail(this.emailDTO).subscribe({next:()=>{a().fire({title:"Corrreo enviado",text:"Te hemos enviado un correo para que puedas restablecer tu contrase\xf1a",icon:"success"}).then(()=>{a().close()})},error:()=>{a().fire({title:"Datos Incorrectos",text:"Correo incorrecto",imageUrl:"assets/svg/cancel-action.svg"}).then(()=>{a().close()})}})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(w),t.Y36(n.qu))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-restablecer"]],decls:21,vars:1,consts:[[1,"container-card"],[1,"pb-70"],[1,"card","deep-shadow"],[1,"card-body","w-100"],[1,"form","text-center",3,"formGroup","ngSubmit"],[1,"mb-3","title"],[1,"mb-3","max-form"],[1,"input-group","custom-border"],[1,"input-group-text","transparent-bg"],[1,"bi","bi-envelope-at"],["formControlName","correo","type","text","placeholder","Correo electr\xf3nico",1,"form-control","no-outline"],["type","submit",1,"btn-confirm"],["routerLink","/",1,"link","back"],[1,"bi","bi-arrow-90deg-left"]],template:function(e,r){1&e&&(t.TgZ(0,"div",0)(1,"article",1)(2,"div",2)(3,"div",3)(4,"form",4),t.NdJ("ngSubmit",function(){return r.onSendEmail()}),t.TgZ(5,"h5",5),t._uU(6,"Recuperar contrase\xf1a"),t.qZA(),t.TgZ(7,"p"),t._uU(8,"Ingrese el correo electr\xf3nico para reestablecer la contrase\xf1a"),t.qZA(),t.TgZ(9,"div",6)(10,"div",7)(11,"span",8),t._UZ(12,"i",9),t.qZA(),t._UZ(13,"input",10),t.qZA()(),t.TgZ(14,"div",6)(15,"button",11),t._uU(16,"Restablecer contrase\xf1a"),t.qZA()(),t.TgZ(17,"div")(18,"a",12),t._UZ(19,"i",13),t._uU(20," Volver a inicio sesi\xf3n"),t.qZA()()()()()()()),2&e&&(t.xp6(4),t.Q6J("formGroup",r.formularioEmail))},dependencies:[c.yS,n._Y,n.Fj,n.JJ,n.JL,n.sg,n.u],styles:[".container-card[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background:var(--light)}article[_ngcontent-%COMP%]{width:80%;max-width:600px}.btn-confirm[_ngcontent-%COMP%]{width:100%;display:block;background-color:var(--red);color:#fff;padding:10px 34px;border-radius:4px;border:none;transition:.3s background}.btn-confirm[_ngcontent-%COMP%]:hover{background-color:#bf1131}a[_ngcontent-%COMP%]{display:block;text-decoration:none;color:var(--red);font-weight:500}.deep-shadow[_ngcontent-%COMP%]{box-shadow:0 8px 16px #0003}"]}),o})();class _{constructor(i,e,r){this.password=i,this.confirmPassword=e,this.tokenPassword=r}}const M=[{path:"",canActivate:[f],component:u},{path:"restablecer",canActivate:[f],component:O},{path:"password-reset/:token",canActivate:[f],component:(()=>{class o{constructor(e,r,p,C){this.emailPasswordService=e,this.router=r,this.activatedRoute=p,this.fb=C,this.toggleBtn1=!1,this.toggleBtn2=!1,this.correo="",this.tokenPassword=""}ngOnInit(){this.formularioPassword=this.iniciarFormulario()}iniciarFormulario(){this.tokenPassword=this.activatedRoute.snapshot.params.token;const e=this.getEmail(this.tokenPassword);return this.fb.group({correo:[e],password:["",[n.kI.required]],confirmPassword:["",[n.kI.required]]})}onChangePassword(){const e=this.formularioPassword.get("password")?.value,r=this.formularioPassword.get("confirmPassword")?.value;e===r?(this.changePasswordDTO=new _(e,r,this.tokenPassword),this.emailPasswordService.changePassword(this.changePasswordDTO).subscribe({next:()=>{a().fire("\xc9xito","Contrase\xf1a se cambio correctamente","success"),this.router.navigate(["/"])},error:()=>{a().fire("Error","Error al cambiar la contrase\xf1a","error")}})):a().fire("error","las contra o coinciden","error")}getEmail(e){try{const r=e.split(".")[1],p=atob(r);return JSON.parse(p).correo}catch{return""}}seePassword(e){1===e?this.toggleBtn1=!this.toggleBtn1:2===e&&(this.toggleBtn2=!this.toggleBtn2)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(w),t.Y36(c.F0),t.Y36(c.gz),t.Y36(n.qu))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-cambiar-contrasenia"]],decls:21,vars:3,consts:[[1,"container-card"],[1,"py-70"],[1,"card","deep-shadow"],[1,"card-body","w-100"],[1,"text-center","mb-4"],[3,"formGroup","ngSubmit"],[1,"mb-3"],[1,"input-group","custom-border"],[1,"input-group-text","transparent-bg"],[1,"bi","bi-envelope-at"],["type","text","formControlName","correo","autocomplete","off","readonly","",1,"form-control","opacity-7","no-outline"],["formControlName","password","placeholder","Nueva contrase\xf1a",1,"form-control","no-outline",3,"type"],["formControlName","confirmPassword","placeholder","Confirmar nueva contrase\xf1a",1,"form-control","no-outline",3,"type"],[1,"mb-3","mt-3","text-center"],["type","submit",1,"btn-confirm"]],template:function(e,r){1&e&&(t.TgZ(0,"div",0)(1,"article",1)(2,"div",2)(3,"div",3)(4,"h5",4),t._uU(5,"Restablezca su contrase\xf1a"),t.qZA(),t.TgZ(6,"form",5),t.NdJ("ngSubmit",function(){return r.onChangePassword()}),t.TgZ(7,"div",6)(8,"div",7)(9,"span",8),t._UZ(10,"i",9),t.qZA(),t._UZ(11,"input",10),t.qZA()(),t.TgZ(12,"div",6)(13,"div",7),t._UZ(14,"input",11),t.qZA()(),t.TgZ(15,"div",6)(16,"div",7),t._UZ(17,"input",12),t.qZA()(),t.TgZ(18,"div",13)(19,"button",14),t._uU(20,"Cambiar contrase\xf1a"),t.qZA()()()()()()()),2&e&&(t.xp6(6),t.Q6J("formGroup",r.formularioPassword),t.xp6(8),t.Q6J("type",r.toggleBtn1?"text":"password"),t.xp6(3),t.Q6J("type",r.toggleBtn2?"text":"password"))},dependencies:[n._Y,n.Fj,n.JJ,n.JL,n.sg,n.u],styles:[".container-card[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background:var(--light)}article[_ngcontent-%COMP%]{width:80%;max-width:600px}.opacity-7[_ngcontent-%COMP%]{opacity:.7}.py-70[_ngcontent-%COMP%]{padding-top:50px;padding-bottom:80px}@media only screen and (min-width: 500px){.py-70[_ngcontent-%COMP%]{padding-top:0;padding-bottom:0}}.btn-confirm[_ngcontent-%COMP%]{width:100%;display:block;background-color:var(--red);color:#fff;padding:10px 34px;border-radius:4px;border:none;transition:.3s background}.btn-confirm[_ngcontent-%COMP%]:hover{background-color:#bf1131}.deep-shadow[_ngcontent-%COMP%]{box-shadow:0 8px 16px #0003}"]}),o})()}];let k=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[c.Bz.forChild(M),c.Bz]}),o})(),T=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[v.ez,k,n.UX]}),o})()},5861:(y,b,s)=>{function v(t,n,h,m,l,g,a){try{var u=t[g](a),d=u.value}catch(f){return void h(f)}u.done?n(d):Promise.resolve(d).then(m,l)}function c(t){return function(){var n=this,h=arguments;return new Promise(function(m,l){var g=t.apply(n,h);function a(d){v(g,m,l,a,u,"next",d)}function u(d){v(g,m,l,a,u,"throw",d)}a(void 0)})}}s.d(b,{Z:()=>c})}}]);